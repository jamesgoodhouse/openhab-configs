rule "Lights — Turn on at Sunset"
when
  Channel "astro:sun:home:set#event" triggered START
then
  val dimLevelLanding = (Light_Landing_AutomationDimmerValue.state as Number).intValue
  Light_Landing_Dimmer.sendCommand(dimLevelLanding)

  val dimLevelLivingRoom = (Light_LivingRoom_AutomationDimmerValue.state as Number).intValue
  Light_LivingRoom_Dimmer.sendCommand(dimLevelLivingRoom)
end

rule "Lights — Turn off at Midnight"
when
  Time is midnight
then
  Light_Landing_Dimmer.sendCommand(0)
  Light_LivingRoom_Dimmer.sendCommand(0)
end

var Timer GarageLightsTimer

rule "Garage Lights — Cancel Auto Off Timer"
when
  Item Light_Garage_Switch changed from ON to OFF
then
  if (GarageLightsTimer !== null) GarageLightsTimer.cancel()
end

rule "Garage Lights — Turn On When Door Opens (Auto Off)"
when
  Item Sensor_Tilt_GarageDoor_State changed from CLOSED to OPEN or
  Item Sensor_Binary_GarageEntryDoor_State changed from CLOSED to OPEN
then
  if (Light_Garage_Switch.state == OFF) {
    Light_Garage_Switch.sendCommand(ON)

    GarageLightsTimer = createTimer(now.plusSeconds(300), [ |
      if (Light_Garage_Switch.state == ON) Light_Garage_Switch.sendCommand(OFF)
    ])
  }
end
